rules:
  - id: py-unsafe-html-echo
    languages: [python]
    message: "Потенциально небезопасный вывод пользовательских данных в HTMLResponse"
    severity: WARNING
    patterns:
      - pattern: |
          HTMLResponse(f"...{$X}...")
    metadata:
      category: security
      cwe: "CWE-79: Cross-site Scripting"

  - id: py-hardcoded-secret-pattern
    languages: [python]
    message: "Обнаружен паттерн, похожий на хардкод секрета (password, secret, api_key, token)"
    severity: ERROR
    patterns:
      - pattern-either:
          - pattern: |
              $VAR = $VALUE
              ...
              password = $X
          - pattern: |
              $VAR = $VALUE
              ...
              secret = $X
          - pattern: |
              $VAR = $VALUE
              ...
              api_key = $X
          - pattern: |
              $VAR = $VALUE
              ...
              token = $X
    metadata:
      category: security
      cwe: "CWE-798: Use of Hard-coded Credentials"

  - id: py-unsafe-eval
    languages: [python]
    message: "Использование eval() может привести к выполнению произвольного кода"
    severity: ERROR
    patterns:
      - pattern: eval($X)
    metadata:
      category: security
      cwe: "CWE-95: Improper Neutralization of Directives in Dynamically Evaluated Code"
